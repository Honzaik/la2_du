(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15121,        388]
NotebookOptionsPosition[     14246,        364]
NotebookOutlinePosition[     14589,        379]
CellTagsIndexPosition[     14546,        376]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", 
       RowBox[{"-", "0.5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"-", "2"}], "}"}], ",", 
     RowBox[{"{", "0.01", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"A", ",", 
          RowBox[{"100", "-", "i"}]}], "]"}], ".", "B"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{"A", ",", "100"}], "]"}], ".", "x0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PseudoInverse", "[", "m", "]"}], ".", "b"}]}], "Input",
 CellChangeTimes->{{3.767004248045868*^9, 3.767004284190528*^9}, {
  3.767004480964877*^9, 3.7670045039737153`*^9}, {3.767005795471227*^9, 
  3.767005825263816*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"634a2158-efca-4938-a01c-79a489a34f4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.7308825341941907`", ",", "0.5540830438570659`", ",", 
   "0.3933562344596778`", ",", "0.24724095318932493`", ",", 
   "0.11440887930718402`", ",", 
   RowBox[{"-", "0.006347551494760462`"}], ",", 
   RowBox[{"-", "0.11612612495107351`"}], ",", 
   RowBox[{"-", "0.21592482809317634`"}], ",", 
   RowBox[{"-", "0.30665092185872417`"}], ",", 
   RowBox[{"-", "0.389129188918313`"}], ",", 
   RowBox[{"-", "0.46410943169975744`"}], ",", 
   RowBox[{"-", "0.5322732887737978`"}], ",", 
   RowBox[{"-", "0.5942404315683806`"}], ",", 
   RowBox[{"-", "0.6505741977452736`"}], ",", 
   RowBox[{"-", "0.7017867124515398`"}], ",", 
   RowBox[{"-", "0.7483435440026909`"}], ",", 
   RowBox[{"-", "0.7906679363219192`"}], ",", 
   RowBox[{"-", "0.8291446566121267`"}], ",", 
   RowBox[{"-", "0.8641234932395881`"}], ",", 
   RowBox[{"-", "0.8959224356281895`"}], ",", 
   RowBox[{"-", "0.9248305650723724`"}], ",", 
   RowBox[{"-", "0.9511106827489025`"}], ",", 
   RowBox[{"-", "0.9750016988184753`"}], ",", 
   RowBox[{"-", "0.9967208043362684`"}], ",", 
   RowBox[{"-", "1.0164654457160809`"}], ",", 
   RowBox[{"-", "1.034415119697728`"}], ",", 
   RowBox[{"-", "1.0507330051355894`"}], ",", 
   RowBox[{"-", "1.0655674464427356`"}], ",", 
   RowBox[{"-", "1.0790533021765056`"}], ",", 
   RowBox[{"-", "1.091313171025387`"}], ",", 
   RowBox[{"-", "1.102458506342552`"}], ",", 
   RowBox[{"-", "1.1125906293581564`"}], ",", 
   RowBox[{"-", "1.1218016502814332`"}], ",", 
   RowBox[{"-", "1.1301753056662305`"}], ",", 
   RowBox[{"-", "1.13778771965241`"}], ",", 
   RowBox[{"-", "1.1447080960034817`"}], ",", 
   RowBox[{"-", "1.150999347231729`"}], ",", 
   RowBox[{"-", "1.1567186665301357`"}], ",", 
   RowBox[{"-", "1.161918047710505`"}], ",", 
   RowBox[{"-", "1.1666447578744776`"}], ",", 
   RowBox[{"-", "1.1709417671144529`"}], ",", 
   RowBox[{"-", "1.1748481391507934`"}], ",", 
   RowBox[{"-", "1.1783993864565578`"}], ",", 
   RowBox[{"-", "1.1816277930981616`"}], ",", 
   RowBox[{"-", "1.1845627082268928`"}], ",", 
   RowBox[{"-", "1.1872308128893756`"}], ",", 
   RowBox[{"-", "1.1896563625825416`"}], ",", 
   RowBox[{"-", "1.1918614077581464`"}], ",", 
   RowBox[{"-", "1.1938659942814245`"}], ",", 
   RowBox[{"-", "1.1956883456662228`"}], ",", 
   RowBox[{"-", "1.1973450287433116`"}], ",", 
   RowBox[{"-", "1.198851104267938`"}], ",", 
   RowBox[{"-", "1.2002202638357802`"}], ",", 
   RowBox[{"-", "1.2014649543520006`"}], ",", 
   RowBox[{"-", "1.202596491184928`"}], ",", 
   RowBox[{"-", "1.2036251610330437`"}], ",", 
   RowBox[{"-", "1.2045603154404219`"}], ",", 
   RowBox[{"-", "1.2054104558107657`"}], ",", 
   RowBox[{"-", "1.2061833106928956`"}], ",", 
   RowBox[{"-", "1.2068859060402874`"}], ",", 
   RowBox[{"-", "1.2075246290833703`"}], ",", 
   RowBox[{"-", "1.208105286395264`"}], ",", 
   RowBox[{"-", "1.208633156678804`"}], ",", 
   RowBox[{"-", "1.2091130387547493`"}], ",", 
   RowBox[{"-", "1.209549295187427`"}], ",", 
   RowBox[{"-", "1.2099458919444064`"}], ",", 
   RowBox[{"-", "1.2103064344507515`"}], ",", 
   RowBox[{"-", "1.2106342003656105`"}], ",", 
   RowBox[{"-", "1.2109321693791189`"}], ",", 
   RowBox[{"-", "1.2112030503004898`"}], ",", 
   RowBox[{"-", "1.211449305683555`"}], ",", 
   RowBox[{"-", "1.2116731742136138`"}], ",", 
   RowBox[{"-", "1.2118766910591217`"}], ",", 
   RowBox[{"-", "1.2120617063732193`"}], ",", 
   RowBox[{"-", "1.212229902113309`"}], ",", 
   RowBox[{"-", "1.212382807331572`"}], ",", 
   RowBox[{"-", "1.2125218120754473`"}], ",", 
   RowBox[{"-", "1.212648180024425`"}], ",", 
   RowBox[{"-", "1.212763059978041`"}], ",", 
   RowBox[{"-", "1.2128674962995103`"}], ",", 
   RowBox[{"-", "1.212962438409937`"}], ",", 
   RowBox[{"-", "1.2130487494194155`"}], ",", 
   RowBox[{"-", "1.213127213973487`"}], ",", 
   RowBox[{"-", "1.2131985453862792`"}], ",", 
   RowBox[{"-", "1.213263392125181`"}], ",", 
   RowBox[{"-", "1.2133223437060014`"}], ",", 
   RowBox[{"-", "1.2133759360522014`"}], ",", 
   RowBox[{"-", "1.2134246563669286`"}], ",", 
   RowBox[{"-", "1.2134689475621356`"}], ",", 
   RowBox[{"-", "1.2135092122850504`"}], ",", 
   RowBox[{"-", "1.2135458165786095`"}], ",", 
   RowBox[{"-", "1.2135790932091182`"}], ",", 
   RowBox[{"-", "1.2136093446913985`"}], ",", 
   RowBox[{"-", "1.213636846038926`"}], ",", 
   RowBox[{"-", "1.2136618472639515`"}], ",", 
   RowBox[{"-", "1.2136845756503376`"}], ",", 
   RowBox[{"-", "1.21370523781978`"}], ",", 
   RowBox[{"-", "1.2137240216101814`"}], ",", 
   RowBox[{"-", "1.2137410977832745`"}], ",", 
   RowBox[{"-", "1.2137566215769955`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.767005832767267*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"777fe2dc-96c9-4cf1-940b-bb62eef6f420"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", 
       RowBox[{"-", "0.5"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.01", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"-", "2"}], "}"}], ",", 
     RowBox[{"{", "0.01", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"A", ",", 
          RowBox[{"100", "-", "i"}]}], "]"}], ".", "B"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{"A", ",", "100"}], "]"}], ".", "x0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PseudoInverse", "[", "m", "]"}], ".", "b"}]}], "Input",
 CellChangeTimes->{{3.7670057872880993`*^9, 3.7670057887285285`*^9}, {
  3.7670058437381706`*^9, 3.767005897763647*^9}, {3.7670107613109665`*^9, 
  3.7670107676162176`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"5d8004e1-ff7f-4d01-88d6-d6931e9ff191"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.726993619732953`", ",", "4.468408312963309`", ",", "3.337047891030294`", 
   ",", "2.3213464553123617`", ",", "1.410789552517226`", ",", 
   "0.5958185887428508`", ",", 
   RowBox[{"-", "0.13225606683085211`"}], ",", 
   RowBox[{"-", "0.781334078585759`"}], ",", 
   RowBox[{"-", "1.3585969595963077`"}], ",", 
   RowBox[{"-", "1.8705733581119852`"}], ",", 
   RowBox[{"-", "2.3231984089050504`"}], ",", 
   RowBox[{"-", "2.7218676890412006`"}], ",", 
   RowBox[{"-", "3.071486268580156`"}], ",", 
   RowBox[{"-", "3.3765133021216513`"}], ",", 
   RowBox[{"-", "3.641002566574553`"}], ",", 
   RowBox[{"-", "3.868639313674191`"}], ",", 
   RowBox[{"-", "4.062773772270854`"}], ",", 
   RowBox[{"-", "4.22645160495573`"}], ",", 
   RowBox[{"-", "4.362441595902616`"}], ",", 
   RowBox[{"-", "4.473260821633142`"}], ",", 
   RowBox[{"-", "4.56119753353062`"}], ",", 
   RowBox[{"-", "4.628331960125321`"}], ",", 
   RowBox[{"-", "4.676555218262955`"}], ",", 
   RowBox[{"-", "4.707586505075984`"}], ",", 
   RowBox[{"-", "4.722988727048461`"}], ",", 
   RowBox[{"-", "4.7241827082568015`"}], ",", 
   RowBox[{"-", "4.712460106952291`"}], ",", 
   RowBox[{"-", "4.6889951579088205`"}], ",", 
   RowBox[{"-", "4.654855347284485`"}], ",", 
   RowBox[{"-", "4.611011117041173`"}], ",", 
   RowBox[{"-", "4.558344687144251`"}], ",", 
   RowBox[{"-", "4.497658075744047`"}], ",", 
   RowBox[{"-", "4.429680390249948`"}], ",", 
   RowBox[{"-", "4.355074455579584`"}], ",", 
   RowBox[{"-", "4.2744428398398835`"}], ",", 
   RowBox[{"-", "4.188333332218972`"}], ",", 
   RowBox[{"-", "4.097243922887866`"}], ",", 
   RowBox[{"-", "4.001627330183859`"}], ",", 
   RowBox[{"-", "3.9018951162317594`"}], ",", 
   RowBox[{"-", "3.7984214284177558`"}], ",", 
   RowBox[{"-", "3.691546400729295`"}], ",", 
   RowBox[{"-", "3.581579245882237`"}], ",", 
   RowBox[{"-", "3.4688010663455437`"}], ",", 
   RowBox[{"-", "3.3534674098182764`"}], ",", 
   RowBox[{"-", "3.2358105923904827`"}], ",", 
   RowBox[{"-", "3.1160418105076677`"}], ",", 
   RowBox[{"-", "2.994353060938468`"}], ",", 
   RowBox[{"-", "2.8709188861998323`"}], ",", 
   RowBox[{"-", "2.7458979613071572`"}], ",", 
   RowBox[{"-", "2.619434536274449`"}], ",", 
   RowBox[{"-", "2.4916597474780753`"}], ",", 
   RowBox[{"-", "2.362692809805642`"}], ",", 
   RowBox[{"-", "2.232642100427701`"}], ",", 
   RowBox[{"-", "2.10160614404475`"}], ",", 
   RowBox[{"-", "1.969674508566337`"}], ",", 
   RowBox[{"-", "1.836928619364777`"}], ",", 
   RowBox[{"-", "1.7034424995058113`"}], ",", 
   RowBox[{"-", "1.5692834426855644`"}], ",", 
   RowBox[{"-", "1.4345126249914284`"}], ",", 
   RowBox[{"-", "1.299185661048302`"}], ",", 
   RowBox[{"-", "1.163353109606092`"}], ",", 
   RowBox[{"-", "1.027060933164717`"}], ",", 
   RowBox[{"-", "0.8903509158150091`"}], ",", 
   RowBox[{"-", "0.7532610430940901`"}], ",", 
   RowBox[{"-", "0.6158258473084344`"}], ",", 
   RowBox[{"-", "0.4780767214639243`"}], ",", 
   RowBox[{"-", "0.34004220465682167`"}], ",", 
   RowBox[{"-", "0.20174824152008886`"}], ",", 
   RowBox[{"-", "0.06321841808369166`"}], ",", "0.07552582380694428`", ",", 
   "0.21446499156507093`", ",", "0.3535813646572805`", ",", 
   "0.4928588335077464`", ",", "0.6322827530475372`", ",", 
   "0.7718398095776222`", ",", "0.9115178997352507`", ",", 
   "1.0513060204633673`", ",", "1.191194168982841`", ",", 
   "1.3311732518580937`", ",", "1.4712350023295078`", ",", 
   "1.6113719051610707`", ",", "1.7515771283200374`", ",", 
   "1.8918444608675578`", ",", "2.0321682564955785`", ",", 
   "2.1725433821967832`", ",", "2.3129651716008808`", ",", 
   "2.4534293825530624`", ",", "2.59393215854896`", ",", "2.734469993675505`",
    ",", "2.875039700739001`", ",", "3.015638382290642`", ",", 
   "3.1562634042860447`", ",", "3.2969123721394133`", ",", 
   "3.43758310895457`", ",", "3.5782736357349867`", ",", 
   "3.7189821533929166`", ",", "3.8597070263940356`", ",", 
   "4.000446767888965`", ",", "4.141200026196452`", ",", 
   "4.28196557251535`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.767005898251631*^9, {3.7670107614561124`*^9, 3.7670107677453494`*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"bcd0546a-625f-48f3-bcef-6c07c4bce6a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"diffMatrix", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "100"}], "}"}]}], "]"}], "//", 
    "LowerTriangularize"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"converted", "=", 
   RowBox[{"m", ".", "diffMatrix"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{"PseudoInverse", "[", "converted", "]"}], ".", "b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"us", "=", 
   RowBox[{"diffMatrix", ".", "sol"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", ".", "us"}], "-", "b"}]}], "Input",
 CellChangeTimes->{{3.76700786569744*^9, 3.7670079435667925`*^9}, {
  3.767008072493722*^9, 3.7670080824375973`*^9}, {3.76701077981133*^9, 
  3.7670107835960913`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"5817e5e2-1e3a-4af5-922e-5e63ecf667c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.093170329928398`*^-11"}], ",", 
   RowBox[{"-", "1.3890222305690259`*^-11"}], ",", 
   RowBox[{"-", "4.0880632212747514`*^-12"}]}], "}"}]], "Output",
 CellChangeTimes->{3.767010788450415*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"68ee8a22-1bc3-40f0-945e-f0ca67943f5b"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1492, 46, 124, "Input",ExpressionUUID->"634a2158-efca-4938-a01c-79a489a34f4c"],
Cell[2075, 70, 4774, 102, 90, "Output",ExpressionUUID->"777fe2dc-96c9-4cf1-940b-bb62eef6f420"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6886, 177, 1645, 50, 124, "Input",ExpressionUUID->"5d8004e1-ff7f-4d01-88d6-d6931e9ff191"],
Cell[8534, 229, 4251, 87, 90, "Output",ExpressionUUID->"bcd0546a-625f-48f3-bcef-6c07c4bce6a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12822, 321, 1072, 30, 105, "Input",ExpressionUUID->"5817e5e2-1e3a-4af5-922e-5e63ecf667c7"],
Cell[13897, 353, 333, 8, 35, "Output",ExpressionUUID->"68ee8a22-1bc3-40f0-945e-f0ca67943f5b"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

